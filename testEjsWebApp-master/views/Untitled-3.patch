
if{
    
}else {
    if (req.cookies.userinfo) {
        var url = myconst.apiurl + "o/token/";
        var loginData = {
            "username": req.cookies.userinfo.email,
            "password": req.cookies.userinfo.password,
            "grant_type": "password",
            "scope": myconst.scope_prj001,
            "client_id": myconst.client_id,
            "client_secret": myconst.client_secret
        };
        console.log(">>>Info used for prj001 authentication: " + JSON.stringify(loginData));
        request.post({url: url,form: loginData}, function (error, response, body) {
            console.log(">>>Authentication results: " + body);
            // console.log(">>>Page Num is:", page);
            if (!error && response.statusCode == 200) {
                var obj = JSON.parse(body); //由JSON字符串转换为JSON对象
                // 成功后将token写入Cookie，maxAge为cookie过期时间
                res.cookie("prj001token", {
                    "access_token": obj.access_token,
                    "refresh_token": obj.refresh_token,
                    "scope": obj.scope,
                    "expires_in": obj.expires_in
                }, {
                    maxAge: 1000 * 60 * 60 * 4,
                    httpOnly: true
                }); //cookie 4小时有效时间

                //进一步发起数据请求，获取所有prj001项目的案例
                url = myconst.apiurl + "prj001/geninfo/";
                var authstring = obj.access_token;
                var page = req.body.page_num;
                if (typeof(parseInt(page)) != typeof(1)){
                    page = 1;
                }
                console.log(">>> prj001 access_token: " + authstring);
                var options = {
                    url: url,
                    headers: {
                        'Authorization': 'Bearer ' + authstring
                    },
                    form: {"page":page}
                };
                
                request(options, function (error, response, body) {
                    //console.log(">>>cookie里面没有prj001的access_token, prj001.js -> archiveobjs->id: ", archiveobjs[1].id);
                    if (!error && response.statusCode == 200) {
                        var archiveobjs = JSON.parse(body);
                        res.render('prj001', {
                            title: '流调项目-排卵障碍性异常子宫出血',
                            archives: archiveobjs.results,
                            username: req.cookies.userinfo.email
                        });
                    } else {
                        console.log(">>>Getting archives met unknown error. " + err.error_description);
                        res.redirect("login");
                    }
                });
            } else {
                console.log(">>>Invoking access token met unknown error. " + err.error_description);
                res.redirect("login");
            }
        });
    } else {
        console.log(">>>Failed to find cookie with user info");
        res.redirect("login");
    }
}

<div class="row">
                                                <div class="col-sm-6"></div>
                                                <div class="col-sm-6">
                                                    <div class="dataTables_paginate paging_bootstrap">
                                                        <ul class="pagination">
                                                            <li class="prev disabled">
                                                                <a href=" ">
                                                                    <i class="icon-double-angle-left"></i>
                                                                </a >
                                                            </li>
                                                            <li class="active page-class" id="first-page"><a href="#">1</a ></li>
                                                            <li class="page-class" id="second-page"><a href="#">2</a ></li>
                                                            <li class="page-class" id="third-page"><a href="#">3</a ></li>
                                                            <li class="next">
                                                                <a href="#">
                                                                    <i class="icon-double-angle-right"></i>
                                                                </a >
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                        </div>

        spirit_jinglichongpei	
        spirit_jianwang	
        spirit_jingshenbujizhong	
        spirit_shenpifali	
        spirit_yalida	
        spirit_jiaodabiangu
        spirit_beishangyuku	
        mood_zhengchang	
        mood_leguankailang	
        mood_silvguodu	
        mood_xinuwuchang	
        mood_fanzaoyinu	
        mood_jiaolv	
        mood_beishangyuku	
        mood_yiyu	
        mood_duosiduolv	
        mood_qita	
        chillfever_zhengchang	
        chillfever_weihan	
        chillfever_wuxinfanre	
        chillfever_wuhouchaore	
        chillfever_direbutui	
        sweat_zhengchang	
        sweat_duohan	
        sweat_mingxian	
        sweat_zihan	
        sweat_daohan	
        sweat_hongre	
        sweat_chaore	
        sound_zhengchang	
        sound_qiduan	
        sound_xitanxi	
        sound_shaoqilanyan	
        face_zhengchang	
        face_danbaiwuhua	
        face_cangbai	
        face_qingbai	
        face_weihuang	
        face_huangzhong	
        face_chaohong	
        face_huian	
        face_baierfuzhong	
        face_baierandan	
        face_mianmulihei	
        face_shaohua	
        face_wuhua	
        heart_zhengcheng	
        heart_xinfan	
        heart_xinji	
        breast_zhengchang	
        breast_biezhang	
        breast_citong	
        breast_zhangtong	
        breast_chutong	
        chest_zhengchang	
        chest_zhangmen	
        chest_yintong	
        chest_citong	
        waist_zhengchang	
        waist_suantong	
        waist_suanruan	
        waist_suanleng	
        waist_lengtong	
        waist_yaotongrushe	
        stomach_zhengchang	
        stomach_zhangtongjuan	
        stomach_xiaofuzhuizhang	
        stomach_xiaofubiezhang	
        stomach_xiaofulengtong	
        stomach_xiaofuzhuotong	
        stomach_yintongxian	
        stomach_dewentongjian
        stomach_tongruzhenci
        stomach_kongzhui	
        head_zhengchang	
        head_touyun	
        head_toutong	
        head_touchenzhong	
        eyes_zhengchang	
        eyes_muxuan	
        eyes_muse	
        eyes_yanhua	
        eyes_mutong	
        eyes_muyang	
        eyes_chenqifz	
        ear_erming	
        ear_erlong	
        ear_tinglibq
        throat_zhengchang	
        throat_yangan	
        throat_yantong	
        throat_yanyang	
        throat_yiwugan	
        breath_wuyiwei	
        breath_kouku	
        breath_kougan	
        breath_koudan	
        breath_kouxian	
        breath_koutian	
        breath_kounian	
        breath_danyuss	
        diet_nadaishishao	
        diet_shiyuws
        diet_yanshi	
        diet_xireyin	
        diet_xilengyin	
        diet_shiyujiantui
        diet_shihoufuzhang	
        diet_shixinla	
        diet_shishengleng	
        diet_kebuduoyin	
        sleep_zhengchang	
        sleep_yiban	
        sleep_duomengyixing	
        sleep_nanyirumian	
        sleep_cheyebumian	
        sleep_duomeng	
        sleep_shishui	
        stool_sehuang
        stool_bianmi	
        stool_zhixi	
        stool_sgsx	
        stool_xiexie	
        stool_tlzqxiexie	
        stool_zhinian
        stool_weixiaohua	
        urine_zhengchang	
        urine_duanchi	
        urine_duanhuang	
        urine_qingchang	
        urine_yeniaopin	
        urine_xbpinshu	
        urine_niaoji	
        urine_niaotong	
        urine_shaoniao	
        urine_yulibujin	
        limb_zhengchang	
        limb_wuli	
        limb_mamu	
        limb_kunzhong	
        limb_zhileng	
        limb_bingliang	
        limb_szxinre	
        limb_fuzhong	
        other_wu	
        other_czjdanbai	
        other_xyjiantui	
        texture_danhong	
        texture_danbai	
        texture_pianhong	
        texture_danan	
        texture_zian	
        texture_yudian	
        coating_bai	
        coating_huang	
        coating_ni	
        coating_bo	
        coating_hou	
        coating_run	
        coating_hua	
        coating_hhouni	
        coating_bairun	
        coating_huangcao	
        coating_wutai	
        coating_shaotai	
        coating_huabo	
        tongue_shoubo	
        tongue_pangda	
        tongue_bianjianhong	
        tongue_youchihen	
        tongue_zhongyouliewen	
        pulse_shi	
        pulse_fu	
        pulse_chen	
        pulse_chi	
        pulse_huan	
        pulse_xi	
        pulse_ruo	
        pulse_shu	
        pulse_hua	
        pulse_se	
        pulse_xian	
        pulse_jin	
        pulse_kou	
        pulse_ru	
        pulse_hong	
        pulse_youli	
        pulse_wuli	
        person                                        
填写信息
$('#recdate').val(result["recdate"]);
单选
$("input[name='title'][value='"+result["title"]+"']").attr("checked",true);
多选
$("input:checkbox[name='wuteshu']").attr('checked',result["wuteshu"]);

select选项，获取选中的值
$('#testSelect option:selected').text();//选中的文本
$('#testSelect option:selected') .val();//选中的值
$("#tesetSelect").find("option:selected").text();//选中的文本
比如<select class="selector"></select>

1、设置value为pxx的项选中

     $(".selector").val("pxx");

2、设置text为pxx的项选中

    $(".selector").find("option[text='pxx']").attr("selected",true);
$(".title").find("option[text='"+result["title"]+"']").attr("selected",true);

<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/public/stylesheets/style.css'/>
    <link rel='stylesheet' href='/public/stylesheets/bootstrap.min.css'/>
    <script src="/public/javascripts/jquery.min.js"></script>
    <script src="/public/javascripts/bootstrap.min.js"></script>
</head>
<body>
<h1>流调项目一案例数据</h1>

<h3>Excel模板上传创建案例：</h3>

<form action="/prj001/file_upload" method="post" enctype="multipart/form-data">
    <input type="file" name="image" size="50"/>
    <br/>
    <input type="submit" value="提交"/>
</form>
<br/>

<% if (archives) { %>
<table class="table table-striped">
    <!--<caption>调查数据</caption>-->
    <thead>
    <tr>
        <th>姓名</th>
        <th>数据链接</th>
    </tr>
    </thead>
    <tbody id="myarchiveslist">
    <% archives.forEach(function(archive){ %>
    <tr>
        <td><%= archive.name %></td>
        <td><%= archive.url %></td>
    </tr>
    <% }) %>
    </tbody>
</table>
<nav aria-label="Page navigation">
    <ul class="pagination">
        <% if (previouspage) { %>
        <li>
            <a href="?page=<%= previouspage %>" arial-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <% } %>
        <% for (var pg=1;pg<=totalpagenumber;pg++){ %>
        <% if (curpage == pg) { %>
        <li class="active"><a href="?page=<%= pg %>"><%= pg %></a></li>
        <% }else {%>
        <li><a href="?page=<%= pg %>"><%= pg %></a></li>
        <% } %>
        <% } %>
        <% if (nextpage) { %>
        <li>
            <a href="?page=<%= nextpage %>" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <% } %>
    </ul>
</nav>
<% }else { %>
<div class="alert alert-warning">目前尚没有数据！</div>
<% } %>
</body>
</html>

ejs文件
/* 分页 */
$(".page-class").click(function () {
        alert($(this).text());
        $.ajax({
                url: "/prj001",//路由，用来处理ajax请求的函数的所在地址
                method: "POST",
                data: {page_num: $(this).text()},
                success: function(){
                    alert("prj001.ejs success");
                    // window.location.href = '/prj001';
                    // $("#infotable").text("");
                    $.cookie()
                },
                error: function(){
                    alert("wrong page");
                }

            })
        });

js文件
/*        分页请求        */
router.post('/', function (req, res, next) {
    console.log(">>>prj001.js router.post方法");
    if (req.cookies.prj001token) {
        //直接发起数据请求，获取所有prj001项目的案例
        var url = myconst.apiurl + "prj001/geninfo/";
        var authstring = req.cookies.prj001token.access_token;
        var page = req.body.page_num;
        console.log(">>> prj001.js access_token: " + authstring);
        console.log(">>>Page Num is:", page, typeof(page));
        var options = {
            url: url,
            headers: {
                'Authorization': 'Bearer ' + authstring
            },
            form: {"page":page}
        };
        request.all(options, function (error, response, body) {
            // console.log(">>>response", response);
            if (!error && response.statusCode == 200) {
                var archiveobjs = JSON.parse(body);
                console.log(">>>prj001.js -> archiveobjs: ", archiveobjs);
                // res.render('error');
                res.render('prj001', {
                    title: '流调项目-排卵障碍性异常子宫出血',
                    archives: archiveobjs.results,
                    username: req.cookies.userinfo.email
                });
            } else {
                console.log(">>>Getting archives met unknown error. " , error.error_description);
                res.redirect("login");
            }
        });
    }
});

    search(req.query.searchContent, function (err,douban) {
        if (err) {
            return next(err);
          }
          res.render('search', {
            results: douban,
            search: req.query.searchContent
          });
        });

        0017030553263367_b.jpg